/*! df-tab-menu - v0.3.0 - Responsive tabs with dropdown menu - built 2015-09-22 - License MIT (http://www.opensource.org/licenses/MIT) */
!function(){"use strict";angular.module("digitalfondue.dftabmenu",[]).directive("dfTabMenu",["$window","$timeout",function(a,b){return{restrict:"A",compile:function(c,d){function e(a){return j?a:""}function f(a){return k?a:""}var g=a.document,h=c[0],i=h.tagName;if("UL"!==i&&"OL"!==i)throw"Wrong element: only OL and UL are supported by df-tab-menu";var j="bootstrap"===d.theme,k="bootstrap"===d.addBootstrapDropDownMenu;angular.element(h).attr("role","tablist").addClass("df-tab-menu "+e("nav nav-tabs"));var l=angular.element(h.querySelector("li[data-more-menu-item]"));l.attr({role:"presentation"}),l.addClass(e("dropdown")),l.addClass(f("dropdown")),l.children().attr({"dropdown-toggle":"","aria-haspopup":"true","aria-expanded":"false"}),l.children().addClass("dropdown-toggle"),l.append("<"+i+' role="menu" aria-hidden="true" class="df-tab-menu-dropdown '+e("dropdown-menu")+f("dropdown-menu")+'"></'+i+">");for(var m=angular.element(h.querySelector(".df-tab-menu-dropdown")),n=h.querySelectorAll("li[data-menu-item]"),o=angular.element(n),p=0;p<o.length;p++){var q=angular.element(n[p]).clone();q.attr({role:"menuitem"}),m.append(q),angular.element(n[p]).attr({role:"presentation"}),angular.element(n[p]).children().attr({"aria-selected":"false",role:"tab"})}return function(c,d,e){var f=d[0],h=angular.element(a),i=!1,k=function(){var a=f.querySelectorAll("li[data-menu-item][role=presentation]");angular.element(a).removeClass("ng-hide");for(var b=[],c=0;c<a.length;c++){var d=a[c].offsetWidth;d>0&&(b[c]=a[c].offsetWidth)}return b},l=(c.$watch(function(){var a=f.querySelector("li[role=presentation].df-tab-menu-active");return null!=a?a.scrollWidth:0},function(a,b){null!=a&&a>0&&o()},!0),function(){return angular.element(f.querySelector("li[data-more-menu-item]")).removeClass("ng-hide"),f.querySelector("li[data-more-menu-item]").offsetWidth}),m=function(a,b){var c=[],d=k(),e=d[b]+l()+40;c.push(b);for(var g=f.querySelectorAll("li[data-menu-item][role=presentation]"),h=0;h<g.length;h++)if(h!=b){if(e+=d[h],e>a)return c;c.push(h)}return c},n=function(){for(var a=f.querySelectorAll("li[data-menu-item][role=presentation]"),b=0;b<a.length;b++)if(angular.element(a[b]).hasClass("df-tab-menu-active"))return b;return 0},o=function(){var a=f.offsetWidth,b=n(),c=m(a,b),d=f.querySelectorAll("li[data-menu-item][role=presentation]"),e=f.querySelectorAll("li[role=menuitem]"),g=f.querySelector("li[data-more-menu-item]");if(c.length<f.querySelectorAll("li[data-menu-item][role=presentation]").length){angular.element(g).removeClass("ng-hide").attr("aria-hidden","false");for(var h=0;h<d.length;h++)-1!=c.indexOf(h)?(angular.element(d[h]).removeClass("ng-hide").attr("aria-hidden","false"),angular.element(e[h]).addClass("ng-hide").attr("aria-hidden","true")):(angular.element(d[h]).addClass("ng-hide").attr("aria-hidden","true"),angular.element(e[h]).removeClass("ng-hide").attr("aria-hidden","false"))}else angular.element(g).addClass("ng-hide").attr("aria-hidden","true"),angular.element(d).removeClass("ng-hide").attr("aria-hidden","false"),i=!1,q()},p=function(a){i=!1,q(a)},q=function(){i?(j&&angular.element(f.querySelector("li[data-more-menu-item]")).addClass("open"),angular.element(f.querySelector("li[data-more-menu-item] [dropdown-toggle]")).addClass("df-tab-menu-dropdown-open").attr({"aria-expanded":"true"}),angular.element(g).bind("click",p)):(j&&angular.element(f.querySelector("li[data-more-menu-item]")).removeClass("open"),angular.element(f.querySelector("li[data-more-menu-item] [dropdown-toggle]")).removeClass("df-tab-menu-dropdown-open").attr({"aria-expanded":"false"}),angular.element(g).unbind("click",p))},r=function(a){a&&a.stopPropagation(),i=!i,q()};angular.element(f.querySelector("li[data-more-menu-item] [dropdown-toggle]")).bind("click",r);var s=function(a){var b=angular.element(f.querySelector("li.df-tab-menu-active")).removeClass("df-tab-menu-active");b.children().attr("aria-selected","false");var c=angular.element(f.querySelector('li[data-menu-item="'+a+'"][role=presentation]')).addClass("df-tab-menu-active");c.children().attr("aria-selected","true"),j&&(b.removeClass("active"),c.addClass("active"))};e.$observe("menuControl",function(a){o(),s(a)}),h.bind("resize",o),c.$on("$destroy",function(){h.unbind("resize",o),angular.element(f.querySelector("li[data-more-menu-item] [dropdown-toggle]")).unbind("click",r),angular.element(g).unbind("click",p)});var t;c.$watch(function(){b.cancel(t),t=b(function(){o(),s(e.menuControl)},25,!1)})}}}}])}();